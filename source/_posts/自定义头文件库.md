---

title: 自定义头文件库
date: 2020-01-27 22:40:00
tags: [教程]
categories: C语言

---


``` c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <Windows.h>
//本自定义头文件库包括以下函数
void SetDataToClip(long, long); //设置指定数据到剪切板
void SCPTC(void);               //SetCursorPosToClip    设置鼠标坐标到剪切板
char *s_gets(char *, int);      //获取指定数量的字符 且将回车符替换为空字符
```

<!--more-->

``` c
void SCPTC(void)
{
    LONG zx = -1;
    LONG zy = -1;
    POINT ptB = {0, 0};
    while (1)
    {
        LPPOINT xy = &ptB;                  //位置变量
        GetCursorPos(xy);                   //获取鼠标当前位置
        if ((zx != xy->x) || (zy != xy->y)) //如果鼠标移动，（即当前的坐标改变则打印出坐标）打印出做坐标。
        {
            system("CLS"); //不要一列输出 在鼠标移动后就进行一个清屏
            printf("x=%d,y=%d\n", xy->x, xy->y);
            zx = xy->x;
            zy = xy->y; //检测鼠标左键的状态  如果鼠标左键被按下
        }
        if (GetKeyState(0x20) < 0 || GetKeyState(0x01) < 0)
            SetDataToClip(zx, zy);
    }
}
void SetDataToClip(long x, long y)
{
    if (!OpenClipboard(NULL) || !EmptyClipboard()) // 打开剪贴板
    {
        printf("打开或清空剪切板出错！/n");
        return;
    }
    HGLOBAL hMen;
    char cz[20]; //直接使用sprintf()就能用了
    sprintf(cz, "%d, %d", x, y);
    TCHAR strText[256]; //这一步用函数可能更稳一些
    strcpy(strText, cz);
    hMen = GlobalAlloc(GMEM_MOVEABLE, ((strlen(strText) + 1) * sizeof(TCHAR))); // 分配全局内存
    if (!hMen)
    {
        printf("分配全局内存出错！/n");
        CloseClipboard(); // 关闭剪切板
        return;
    }
    // 把数据拷贝考全局内存中
    LPSTR lpStr = (LPSTR)GlobalLock(hMen);                       // 锁住内存区
    memcpy(lpStr, strText, ((strlen(strText)) * sizeof(TCHAR))); // 内存复制
    lpStr[strlen(strText)] = (TCHAR)0;                           // 字符结束符
    GlobalUnlock(hMen);                                          // 释放锁
    SetClipboardData(CF_TEXT, hMen);                             // 把内存中的数据放到剪切板上
    CloseClipboard();
    return;
}
char *s_gets(char *st, int n)       //每一维数组只能存储81个字符串
{
    char *ret_val;
    int i = 0;
    ret_val = fgets(st, n, stdin);  //使用fgets()函数来接收值
    if (ret_val)
    {
        while (st[i] != '\n' && st[i] != '\0')  //函数的目的就是把换行变成空字符
            i++;
        if (st[i] == '\n')                      //上面的字符串为换行 把它换成空字符
            st[i] = '\0';
        else                                    //如果不是换行则只有空字符
            while (getchar() != '\n')           //把缓冲区其他的字符串清除掉
                continue;
    }
    return ret_val;
}
//输出二维数组的函数
```