---

title: 自定义头文件库
date: 2020-01-27 22:40:00
tags: [教程]
categories: C语言

---


``` c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <Windows.h>
//本自定义头文件库包括以下函数
void SetDataToClip(long, long); //设置指定数据到剪切板
void SCPTC(void);               //SetCursorPosToClip    设置鼠标坐标到剪切板
void ClickAppointPos(int x, int y);     //鼠标左键点击传入的坐标值
void InputAppointString(char *str);     //按下指定字符串包含的按键
```
<!--more-->
``` c
void SCPTC(void)
{
    LONG zx = -1;
    LONG zy = -1;
    POINT ptB = {0, 0};
    while (1)
    {
        LPPOINT xy = &ptB;                  //位置变量
        GetCursorPos(xy);                   //获取鼠标当前位置
        if ((zx != xy->x) || (zy != xy->y)) //如果鼠标移动，（即当前的坐标改变则打印出坐标）打印出做坐标。
        {
            system("CLS"); //不要一列输出 在鼠标移动后就进行一个清屏
            printf("x=%d,y=%d\n", xy->x, xy->y);
            zx = xy->x;
            zy = xy->y; //检测鼠标左键的状态  如果鼠标左键被按下
        }
        if (GetKeyState(0x20) < 0 || GetKeyState(0x01) < 0) //如果空格或者鼠标左键被按下 就调用这个函数
            SetDataToClip(zx, zy);
    }
}
void SetDataToClip(long x, long y)
{
    if (!OpenClipboard(NULL) || !EmptyClipboard()) // 打开剪贴板
    {
        printf("打开或清空剪切板出错！/n");
        return;
    }
    HGLOBAL hMen;
    char cz[20]; //直接使用sprintf()就能用了
    sprintf(cz, "%d, %d", x, y);
    TCHAR strText[256]; //这一步用函数可能更稳一些
    strcpy(strText, cz);
    hMen = GlobalAlloc(GMEM_MOVEABLE, ((strlen(strText) + 1) * sizeof(TCHAR))); // 分配全局内存
    if (!hMen)
    {
        printf("分配全局内存出错！/n");
        CloseClipboard(); // 关闭剪切板
        return;
    }
    // 把数据拷贝考全局内存中
    LPSTR lpStr = (LPSTR)GlobalLock(hMen);                       // 锁住内存区
    memcpy(lpStr, strText, ((strlen(strText)) * sizeof(TCHAR))); // 内存复制
    lpStr[strlen(strText)] = (TCHAR)0;                           // 字符结束符
    GlobalUnlock(hMen);                                          // 释放锁
    SetClipboardData(CF_TEXT, hMen);                             // 把内存中的数据放到剪切板上
    CloseClipboard();
    return;
}
void InputAppointString(char *str)
{
	int i = 0;
	Sleep(500);
	while (str[i] != '\0')
	{
		int target = str[i];			//数组中得字符转换成int型的数值 然后传给keybd_event()函数
		Sleep(100);
		keybd_event(target, 0, 0, 0);
		keybd_event(target, 0, 2, 0);
		i++;
	}
	printf("字符串%s输入成功\n", str);
}
void ClickAppointPos(int x, int y)
{
	SetCursorPos(x, y);							   //移动鼠标到指定坐标值
	mouse_event(MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0); //左键按下
	mouse_event(MOUSEEVENTF_LEFTUP, 0, 0, 0, 0);   //左键松开
	printf("坐标值%d,%d点击成功\n", x, y);
}
void enter(int i)       //修一下  再加一个sleep函数的参数   要高级一些的  也就是可以自定义是否选择设置这个sleep参数
{                       //在高级一些 自定义函数的参数数量 可以一次调用多个参数
	keybd_event(i, 0, 0, 0); //按下win键
	keybd_event(i, 0, 2, 0); //松开
}
```
